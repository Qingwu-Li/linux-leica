/* Device tree overlay for Colibri FPGA configuration and device probing */

/dts-v1/ /plugin/;

/ {
	fragment@0 {
		/* controlling bridge */
		target-path = "/soc/fpgamgr@ff706000/bridge@0";
		__overlay__ {
			#address-cells = <1>;
	                #size-cells = <1>;

			area@0 {
				compatible = "fpga-area";

				#address-cells = <2>;
				#size-cells = <1>;
				ranges = <0 0x00000000 0xff200000 0x00080000>,
					<1 0x00000000 0xc0000000 0x00040000>;

				firmware-name = "colibri.rbf";

				agpio0: gpio@ff210020 {
					status = "okay";
					compatible = "altr,pio-1.0";
					reg = <0 0x00010020 0x20>;
					interrupts = <0 44 1>;	/* edge triggered */
					width=<32>;
					#gpio-cells = <2>;
					gpio-controller;
					#interrupt-cells = <1>;
					interrupt-controller;
					altr,interrupt-type = <1>;	/* rising edge */
				};

				laser_safety@0 {
					compatible = "generic-uio";
					status = "okay";
					interrupt-parent = <&intc>;
					interrupts = <0 74 4>;
				};

				casa_0: casa@0x00000 {
					compatible = "unknown,unknown-15.0";
					reg = <0 0x00000000 0x00010000>;
				}; //end unknown@0x100000000 (casa_0)


				flash_epc901_cntrl_0: flash_epc901_cntrl@0x1c000 {
					compatible = "unknown,unknown-1.0";
					reg = <0 0x0001c000 0x00000020>;
				};

				fast_axis_ad7276_if_0: fast_axis_ad7276_if@0x1c020 {
					compatible = "unknown,unknown-1.0";
					reg = <0 0x0001c020 0x00000020>;
				};

				/* used for manual CASA triggering */
				trigger_core_0: trigger_core@0x1c0c0 {
					/* status = "disabled"; */
					compatible = "unknown,unknown-1.0";
					reg = <0 0x1c0c0 0x00000010>;
					interrupt-parent = <&intc>;
					interrupts = <0 47 4>;
				};

				casa_fifo_streamer: casa_fifo@0x1c0e0 {
					compatible = "generic-uio";
					reg = <0 0x1c0e0 0x00000020>;
					interrupt-parent = <&intc>;
					interrupts = <0 48 4>;
				};

				casa_adpt_0: casa_adpt@0x20000 {
					compatible = "unknown,unknown-1.1";
					reg = <0 0x00020000 0x00004000>;
					interrupt-parent = <&intc>;
					interrupts = <0 73 4>;
				};

				/* timestamp timer */
				timing_module: timing_module@0x1d000 {
					compatible = "generic-uio";
					reg = <0 0x1d000 0x00000040>;
					interrupt-parent = <&intc>;
					interrupts = <0 50 4>;
				}; //end timing_module@0xff21d000

				msgdma_edm: msgdma@0x10100 {
					compatible = "colibri-edm";
					reg = <0 0x00010100 0x00000020>,
					      <0 0x00010120 0x00000010>,
					      <0 0x00010140 0x00000008>;
					reg-names = "CSR", "Descriptor_Slave", "Response_Slave";
					interrupt-parent = <&intc>;
					interrupts = <0 40 4>;
				}; //end unknown@0xff2110100 (msgdma_edm)

				altera_uart: serial@0x10200 {
					status = "disabled";
					compatible = "altr,uart-16.0", "altr,uart-1.0";
					reg = <0 0x00010200 0x00000020>;
					interrupt-parent = <&intc>;
					interrupts = <0 51 4>;
					clock-frequency = <100000000>;
					current-speed = <9600>;
				}; //end serial@0x10200 (altera_uart)


				msgdma_camera: msgdma@0x50000 {
					compatible = "colibri-fb";
					reg = <0 0x00050000 0x00000020>,
					      <0 0x00050020 0x00000010>,
					      <0 0x00050030 0x00000008>,
					      <0 0x00050040 0x00000040>;
					reg-names = "csr", "descriptor_slave", "response", "img_acq";
					interrupt-parent = <&intc>;
					interrupts = <0 46 4>, <0 75 4>;
					interrupt-names = "msgdma","img_acq";
				}; //end msgdma@0xff21c040 (msgdma_camera)

				angle_estimation: unknown@0x70000 {
					compatible = "unknown,unknown-1.0";
					reg = <0 0x00070000 0x00000040>;
				}; //end unknown@0x70000 (angle_estimation_0)

				/* WLAN module power supply */
				vwlan: vwlan {
					compatible = "regulator-fixed";
					regulator-name = "vwlan";
					regulator-min-microvolt = <3300000>;
					regulator-max-microvolt = <3300000>;
					regulator-always-on;
					regulator-boot-on;
					/* VWLAN pin, module power switch */
					gpio = <&agpio0 8 0>;
					startup-delay-us = <70000>;
					enable-active-high;
				};

				/* WLAN_EN pin */
				wlan_vmmc_reg: regulator@1 {
					compatible = "regulator-fixed";
					regulator-name = "wlan-vmmc-regulator";
					regulator-min-microvolt = <1800000>;
					regulator-max-microvolt = <1800000>;
					/* WLAN_EN pin - HPS_GPIO61, gpio2 3 */
					gpio = <&portc 3 0>;
					/* WLAN card specific delay */
					startup-delay-us = <70000>;
					enable-active-high;
				};

				wlan_elca: sdhci@0x20000 {
					compatible = "elca,sd_mmc_elca-15.11", "generic-sdhci";
					reg = <1 0x00020000 0x00000100>;
					interrupt-parent = <&intc>;
					interrupts = <0 49 4>;
					cap-mmc-highspeed = <1>;
					cap-sd-highspeed = <1>;
					sdhci,auto-cmd12 = <1>;
					vmmc-supply = <&wlan_vmmc_reg>;
					non-removable;
					cap-power-off-card;
					keep-power-in-suspend;
					wakeup-source;

					#address-cells = <1>;
					#size-cells = <0>;
					wlcore: wlcore@0 {
						compatible = "ti,wl1835";
						reg = <2>;
						interrupt-parent = <&porta>; /* HPS_GPIO17 */
						/* 1 - IRQ_TYPE_EDGE_RISING */
						interrupts = <17 1>;
					};
				}; //end sdhci@0x000020000 (wlan_elca)

			      	sdc_elca: sdhci@0x30000 {
					compatible = "elca,sd_mmc_elca-15.11", "generic-sdhci";
					reg = <1 0x00030000 0x00000100>;
					interrupt-parent = <&intc>;
					interrupts = <0 43 4>;
					cap-mmc-highspeed = <1>;
					cap-sd-highspeed = <1>;
					sdhci,auto-cmd12 = <1>;
					vmmc-supply = <&regulator_3_3v>;
					vqmmc-supply = <&regulator_3_3v>;
				}; //end sdhci@0x000030000 (sdc_elca)

			}; /* area@0 */
		}; /* __overlay__ */
	};
};
